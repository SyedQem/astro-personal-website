---
import Layout from "../../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

const projects: CollectionEntry<"projects">[] = await getCollection("projects");

// Optional: newest first if you start using `date` later
// projects.sort((a, b) => (b.data.date ?? "").localeCompare(a.data.date ?? ""));
---

<Layout>
  <main class="relative z-10 px-6 py-20">
    <div class="max-w-4xl mx-auto">
      <header class="text-center">
        <h1 class="text-4xl font-bold">Projects</h1>
        <p class="mt-3 text-gray-300">
          A complete list of my projects, with deeper write-ups for each one.
        </p>
      </header>

      <div class="mt-10 grid gap-6">
        {projects.map((p) => (
          <article class="project-card p-8">
            <h2 class="text-xl font-semibold">{p.data.title}</h2>
            <p class="mt-2 text-gray-300">{p.data.description}</p>

            <div class="mt-4 flex flex-wrap gap-5">
              <a
                href={`/projects/${p.slug}`}
                class="text-sm text-emerald-400 hover:text-emerald-300"
              >
                Read more →
              </a>

              {p.data.repo && (
                <a
                  href={p.data.repo}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-sm text-emerald-400 hover:text-emerald-300"
                >
                  View repository →
                </a>
              )}

              {p.data.demo && (
                <a
                  href={p.data.demo}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-sm text-emerald-400 hover:text-emerald-300"
                >
                  Live demo →
                </a>
              )}
            </div>
          </article>
        ))}
      </div>
    </div>
  </main>
</Layout>
